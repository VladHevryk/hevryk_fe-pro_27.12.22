const product = {
    shoes: [
        {
            href: '/img/shoes1.jpg',
            name: 'shoes first',
            price: '3999 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/shoes2.jpg',
            name: 'shoes second',
            price: '1499 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/shoes3.jpg',
            name: 'shoes third',
            price: '2399 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/shoes4.jpg',
            name: 'shoes forth',
            price: '4599 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/shoes5.jpg',
            name: 'shoes fivth',
            price: '1099 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        }
    ],
    hoody: [
        {
            href: '/img/hoody1.jpg',
            name: 'hoody first',
            price: '3999 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/hoody2.jpg',
            name: 'hoody second',
            price: '1499 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/hoody3.jpg',
            name: 'hoody third',
            price: '2399 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/hoody4.jpg',
            name: 'hoody forth',
            price: '4599 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/hoody5.jpg',
            name: 'hoody fivth',
            price: '1099 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        }
    ],
    tshirt: [
        {
            href: '/img/tshirt1.jpg',
            name: 't-shirt first',
            price: '999 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/tshirt2.jpg',
            name: 't-shirt second',
            price: '499 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/tshirt3.jpg',
            name: 't-shirt third',
            price: '399 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/tshirt4.jpg',
            name: 't-shirt forth',
            price: '599 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/tshirt5.jpg',
            name: 't-shirt fivth',
            price: '1099 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        }
    ],
    jeans: [
        {
            href: '/img/jeans1.jpg',
            name: 'jeans first',
            price: '999 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/jeans2.jpg',
            name: 'jeans second',
            price: '499 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/jeans3.jpg',
            name: 'jeans third',
            price: '399 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/jeans4.jpg',
            name: 'jeans forth',
            price: '599 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/jeans5.jpg',
            name: 'jeans fivth',
            price: '1099 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        }
    ],
    bag: [
        {
            href: '/img/bag1.jpg',
            name: 'bag first',
            price: '3999 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/bag2.jpg',
            name: 'bag second',
            price: '2499 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/bag3.jpg',
            name: 'bag third',
            price: '6399 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/bag4.jpg',
            name: 'bag forth',
            price: '4599 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/bag5.jpg',
            name: 'bag fivth',
            price: '9099 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        }
    ],
    hat: [
        {
            href: '/img/hat1.jpg',
            name: 'hat first',
            price: '999 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/hat2.jpg',
            name: 'hat second',
            price: '299 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/hat3.jpg',
            name: 'hat third',
            price: '699 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/hat4.jpg',
            name: 'hat forth',
            price: '1599 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        },
        {
            href: '/img/hat5.jpg',
            name: 'hat fivth',
            price: '3099 UAH',
            descr: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Corporis totam in sed perferendis, enim possimus'
        }
    ]
};

const catalog = document.querySelector('.catalog');
const mainList = document.querySelector('.main__list');
const wrapperBlock = document.querySelector('.product__wrapp');
const popup = document.querySelector('.popup');
const popupContent = document.querySelector('.popup__content');
const popupCloseIcon = document.querySelector('.popup__close');

mainList.addEventListener('click', (e) => {
    const targetAction = e.target.dataset.action;
    productCatalog(targetAction);
});

function productCatalog(produktKey) {
    if(!wrapperBlock) return;
    wrapperBlock.innerHTML = '';
    Object.values(product[produktKey]).forEach((el) => {
        const mainBlock = document.createElement('div');
        mainBlock.classList.add('product__block');
        wrapperBlock.appendChild(mainBlock);
        const img = document.createElement('img');
        img.src = el.href;
        img.classList.add('product__img');
        mainBlock.appendChild(img);
        const title = document.createElement('h1');
        title.innerText = el.name;
        title.classList.add('product__title');
        mainBlock.appendChild(title);
        const infoBlock = document.createElement('div');
        infoBlock.classList.add('product__info');
        mainBlock.appendChild(infoBlock);
        const price = document.createElement('span');
        price.innerText = el.price;
        price.classList.add('product__price');
        infoBlock.appendChild(price);
        const descr = document.createElement('p');
        descr.innerText = el.descr;
        descr.classList.add('product__descr');
        infoBlock.appendChild(descr);
        const btn = document.createElement('button');
        btn.innerText = 'buy now!';
        btn.classList.add('product__btn');
        infoBlock.appendChild(btn);
        mainBlock.addEventListener('click', () => {
            productInfoActive(infoBlock);
            btn.addEventListener('click', () => {
                activePopup();
            });
        });
    });
};

function productInfoActive(el){
    const blockClass = document.querySelectorAll('.product__info');
    blockClass.forEach(el => el.classList.remove('product__info-active'));
    el.classList.add('product__info-active');
};
 
function activePopup(){
    popup.classList.add('popup-active');
    popupContent.classList.add('popup__content-active');
};
    
function closePopup(){
    popup.classList.remove('popup-active');
    popupContent.classList.remove('popup__content-active');
    wrapperBlock.innerHTML = '';

}

popupCloseIcon.addEventListener('click', () => {
    closePopup();
});


const form = document.querySelector('#get_form');
const firstName = form.firstname;
const lastName = form.lastname;
const phone = form.phone;
const email = form.email;
const city = form.city;
const poshta = form.poshta;
const payment = form.payment;
const quantity = form.quantity;
const textarea = form.textarea;
const submit = document.querySelector('.form__btn');

const formInputs = [
    {
        name: 'firstName',
        inputEl: firstName,
        validationsRules: [validateStringLength, validateForValue],
        errorElValue: firstName.parentElement.querySelector('.form__error'),
        errorElForm: firstName.parentElement.querySelector('.form__error-length')
    },
    {
        name: 'lastName',
        inputEl: lastName,
        validationsRules: [validateStringLength, validateForValue],
        errorElValue: lastName.parentElement.querySelector('.form__error'),
        errorElForm: lastName.parentElement.querySelector('.form__error-length')
    },
    {
        name: 'phone',
        inputEl: phone,
        validationsRules: [isNumber],
        errorElValue: phone.parentElement.querySelector('.form__error'),
        errorElForm: phone.parentElement.querySelector('.form__error-number')
    },
    {
        name: 'email',
        inputEl: email,
        validationsRules: [isEmail],
        errorElValue: email.parentElement.querySelector('.form__error'),
        errorElForm: email.parentElement.querySelector('.form__error-email')
    },
    {
        name: 'city',
        inputEl: city,
        validationsRules: []
    },
    {
        name: 'poshta',
        inputEl: poshta,
        validationsRules: []
    },
    {
        name: 'payment',
        inputEl: payment,
        validationsRules: []
    },
    {
        name: 'quantity',
        inputEl: quantity,
        validationsRules: []
    },
    {
        name: 'textarea',
        inputEl: textarea,
        validationsRules: []
    }
];

submit.addEventListener('click', (e) => {
    e.preventDefault();
    const validatedArr = formInputs.map((el) => {
       const allIsValid = el.validationsRules.map((func) => {
            return func(el.inputEl.value, el.errorElValue, el.errorElForm);
        });
        return allIsValid.every(el => el === true);
    });
    if(validatedArr.every(el => el === true)){
        const data = {};
        formInputs.forEach((input) => {
            data[input.name] = input.inputEl.value;
        });
        sendOnServer(data);
        closePopup();
    } else {
        console.log('sth wrong');
    }
});

function sendOnServer(data){
    console.log(data);
}

function validateStringLength(value, errorElValue, errorElForm){
    const isLength = value.length >= 3;
    if(isLength === true) {
        errorElForm.classList.add('hide');
        errorElValue.classList.add('hide');
    } else {
        errorElForm.classList.remove('hide');
        errorElValue.classList.remove('hide');
        errorElForm.innerHTML = 'not long enought';
    }
    return isLength;
}

function validateForValue(value, errorElValue) {
    const isValue = !!value.trim();
    if(isValue === true) {
        errorElValue.classList.add('hide');
    } else {
        errorElValue.classList.remove('hide');
        errorElValue.innerHTML = 'the fild is empty';
    }
    return isValue;
}

function isNumber(value, errorElValue, errorElForm) {
    const isNum = value ? !isNaN(value) : false;
    if(isNum === true) {
        errorElForm.classList.add('hide');
        errorElValue.classList.add('hide');
    } else {
        errorElForm.classList.remove('hide');
        errorElValue.classList.remove('hide');
        errorElForm.innerHTML = 'it is not a number';
    }
    return isNum;
}

function isEmail(value, errorElValue, errorElForm) {
	const isEmail = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(value);
    if(isEmail === true) {
        errorElForm.classList.add('hide');
        errorElValue.classList.add('hide');
    } else {
        errorElValue.classList.remove('hide');
        errorElForm.classList.remove('hide');
        errorElForm.innerHTML = 'it is not an email';
    }
    return isEmail;
}
